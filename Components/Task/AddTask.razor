@inject TaskService taskService

@rendermode InteractiveServer

<EditForm Model="@taskItem" OnValidSubmit="HandleSubmit">
    <MudToolBar Gutters="false">
        <MudTextField Style="margin: 10px !important;" T="string" Label="Title" Variant="Variant.Outlined" Placeholder="Enter title" @bind-value="@taskItem.Title" Lines="1" />

        <MudSelect Style="margin: 10px !important; width: 200px !important;" Placeholder="Status" @bind-value="@taskItem.Status">
            <MudSelectItem Value="@("To-do")">To-do</MudSelectItem>
            <MudSelectItem Value="@("In progress")">In progress</MudSelectItem>
            <MudSelectItem Value="@("Done")">Done</MudSelectItem>
        </MudSelect>

        <MudInput Style="margin: 10px !important;" InputType="InputType.Date" Placeholder="Due date" @bind-value="@taskItem.DueDate" />
    </MudToolBar>

    <br/>

    <MudTextField Style="margin: 10px !important;" T="string" Label="Description" Variant="Variant.Outlined" Placeholder="Enter description" @bind-value="taskItem.Description" Lines="5" />
    <MudButton Color="Color.Primary" Style="margin: 10px !important;" type="submit">Submit</MudButton>
</EditForm>

@code {
    [Parameter]
    public Guid CurrentTabId { get; set; }

    [Parameter]
    public EventCallback OnSubmitClicked { get; set; }

    public TaskItem taskItem = new TaskItem();

    public void HandleSubmit()
    {
        taskItem.Id = new Guid();
        taskItem.TabId = CurrentTabId;

        taskService.AddTask(taskItem);

        taskItem = new TaskItem();

        OnSubmitClicked.InvokeAsync();
    }
}
