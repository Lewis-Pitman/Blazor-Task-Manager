@inject TaskService taskService

<div class="task-stats">
	<span class="stat-block red">
		<p>To-do</p>
		<p class="number">@todoTasks</p>
	</span>

	<span class="stat-block yellow">
		<p>In progress</p>
		<p class="number">@inProgressTasks</p>
	</span>

	<span class="stat-block green">
		<p>Done</p>
		<p class="number">@doneTasks</p>
	</span>
</div>

<div class="todays-task-block blue">
@if(todaysTasks != null)
{
	<div class="todays-task-block blue">
	<p>Today's tasks:</p>
	@foreach(var task in todaysTasks)
	{
		<p>Title: @task.Title   Description: @task.Description    Status: @task.Status</p>
		<br />
	}
	</div>
}
else
{
	
	<p>You have no tasks due today</p>
}
</div>

@code {
	[Parameter]
	public Guid CurrentTabId { get; set; }

	// Tab stats
	private int todoTasks;
	private int inProgressTasks;
	private int doneTasks;

	private List<TaskItem>? todaysTasks;

	protected override void OnParametersSet()
	{
		var allTasks = taskService.GetAllTasksWithTabId(CurrentTabId);

		todoTasks = allTasks.Where(task => task.Status == "To-do").Count();
		inProgressTasks = allTasks.Where(task => task.Status == "In progress").Count();
		doneTasks = allTasks.Where(task => task.Status == "Done").Count();

		todaysTasks = taskService.GetTaskByDate(DateTime.Today);

		base.OnParametersSet();
	}
}
